package teleporter.task.tests

import com.fasterxml.jackson.annotation.JsonInclude
import com.fasterxml.jackson.databind.{DeserializationFeature, ObjectMapper, SerializationFeature}
import com.fasterxml.jackson.module.scala.DefaultScalaModule
import com.fasterxml.jackson.module.scala.experimental.ScalaObjectMapper

/**
 * Created by joker on 15/10/19.
 */
object Json4sTest {

  def main(args: Array[String]) {
    val json = "{\"headers\":{\"Data-Type\":\"rds_trade\",\"Content-Encoding\":\"utf-8\",\"Data-Stage\":\"INCREMENT\",\"User-Agent\":\"top-collected\",\"Shop-Tag\":\"100764260\",\"Content-Type\":\"application/json\",\"Event-Date\":1320400997607,\"Platform\":\"RDS\"},\"payload\":\"{\\\"adjustFee\\\":\\\"0.00\\\",\\\"alipayId\\\":2088202489622405,\\\"alipayNo\\\":\\\"2015100921001001400078062377\\\",\\\"availableConfirmFee\\\":\\\"0.00\\\",\\\"buyerAlipayNo\\\":\\\"515140094@qq.com\\\",\\\"buyerArea\\\":\\\"山东联通\\\",\\\"buyerCodFee\\\":\\\"0.00\\\",\\\"buyerEmail\\\":\\\"515140094@qq.com\\\",\\\"buyerNick\\\":\\\"泰安市人民政府\\\",\\\"buyerObtainPointFee\\\":4,\\\"buyerRate\\\":true,\\\"codFee\\\":\\\"0.00\\\",\\\"codStatus\\\":\\\"NEW_CREATED\\\",\\\"commissionFee\\\":\\\"0.74\\\",\\\"consignTime\\\":\\\"2015-10-09 15:10:25\\\",\\\"created\\\":\\\"2015-10-09 07:48:58\\\",\\\"discountFee\\\":\\\"0.00\\\",\\\"endTime\\\":\\\"2015-10-13 17:51:50\\\",\\\"hasPostFee\\\":false,\\\"invoiceName\\\":\\\"王涛\\\",\\\"is3D\\\":false,\\\"isBrandSale\\\":false,\\\"isForceWlb\\\":false,\\\"isLgtype\\\":false,\\\"isPartConsign\\\":false,\\\"isWt\\\":false,\\\"modified\\\":\\\"2015-10-13 17:55:16\\\",\\\"orders\\\":[{\\\"adjustFee\\\":\\\"0.00\\\",\\\"buyerRate\\\":true,\\\"cid\\\":350407,\\\"consignTime\\\":\\\"2015-10-09 15:10:25\\\",\\\"discountFee\\\":\\\"250.00\\\",\\\"divideOrderFee\\\":\\\"49.00\\\",\\\"endTime\\\":\\\"2015-10-13 17:51:50\\\",\\\"invoiceNo\\\":\\\"70452709238324\\\",\\\"isDaixiao\\\":false,\\\"isOversold\\\":false,\\\"logisticsCompany\\\":\\\"百世汇通\\\",\\\"num\\\":1,\\\"numIid\\\":35320727625,\\\"oid\\\":1324013142533233,\\\"orderFrom\\\":\\\"WAP,WAP\\\",\\\"outerIid\\\":\\\"JSQ-240WB\\\",\\\"outerSkuId\\\":\\\"JSQ-240WB\\\",\\\"payment\\\":\\\"49.00\\\",\\\"picPath\\\":\\\"http://img04.taobaocdn.com/bao/uploaded/i4/1069640918/TB2AnS9fpXXXXcxXpXXXXXXXXXX_!!1069640918.jpg\\\",\\\"price\\\":\\\"299.00\\\",\\\"refundStatus\\\":\\\"NO_REFUND\\\",\\\"sellerRate\\\":true,\\\"sellerType\\\":\\\"B\\\",\\\"shippingType\\\":\\\"express\\\",\\\"skuId\\\":\\\"104165272884\\\",\\\"skuPropertiesName\\\":\\\"颜色分类:金色\\\",\\\"snapshotUrl\\\":\\\"i:1324013142533233_1\\\",\\\"status\\\":\\\"TRADE_FINISHED\\\",\\\"title\\\":\\\"小熊加湿器 家用大容量 办公室空调空气加湿器 迷你香薰静音\\\",\\\"totalFee\\\":\\\"49.00\\\"}],\\\"payTime\\\":\\\"2015-10-09 07:49:10\\\",\\\"payment\\\":\\\"49.00\\\",\\\"pointFee\\\":0,\\\"postFee\\\":\\\"0.00\\\",\\\"promotionDetails\\\":[{\\\"discountFee\\\":\\\"250.00\\\",\\\"id\\\":1324013142533233,\\\"promotionDesc\\\":\\\"劲爆底价:省250.00元,包邮\\\",\\\"promotionId\\\":\\\"Tmall$tmallItemPromotion_WIRELESS-53826515_347465712\\\",\\\"promotionName\\\":\\\"劲爆底价\\\"}],\\\"realPointFee\\\":0,\\\"receivedPayment\\\":\\\"49.00\\\",\\\"receiverAddress\\\":\\\"岱岳花园小区（光彩大市场路北）20号楼1单元\\\",\\\"receiverCity\\\":\\\"泰安市\\\",\\\"receiverDistrict\\\":\\\"岱岳区\\\",\\\"receiverMobile\\\":\\\"18753857525\\\",\\\"receiverName\\\":\\\"王涛\\\",\\\"receiverState\\\":\\\"山东省\\\",\\\"receiverZip\\\":\\\"271000\\\",\\\"sellerAlipayNo\\\":\\\"402644529@qq.com\\\",\\\"sellerCanRate\\\":false,\\\"sellerCodFee\\\":\\\"0.00\\\",\\\"sellerEmail\\\":\\\"haisazi@163.com\\\",\\\"sellerFlag\\\":5,\\\"sellerMemo\\\":\\\"[已审核]\\\",\\\"sellerMobile\\\":\\\"18924863989\\\",\\\"sellerName\\\":\\\"佛山市顺德区哥登电器有限公司\\\",\\\"sellerNick\\\":\\\"小熊哥登专卖店\\\",\\\"sellerPhone\\\":\\\"13927769876\\\",\\\"sellerRate\\\":true,\\\"serviceOrders\\\":[{\\\"buyerNick\\\":\\\"泰安市人民政府\\\",\\\"itemOid\\\":1324013142513233,\\\"num\\\":1,\\\"oid\\\":1324013142523233,\\\"payment\\\":\\\"0.00\\\",\\\"picPath\\\":\\\"http://img.taobaocdn.com/bao/uploaded///gtd.alicdn.com/tps/i3/T1pLuoXvxXXXajiPzi-54-60.jpg\\\",\\\"price\\\":\\\"0.00\\\",\\\"sellerNick\\\":\\\"小熊哥登专卖店\\\",\\\"serviceDetailUrl\\\":\\\"http://fuwu.tmall.com/protocol/get_protocol.htm?service_item_id=44425396750\\\",\\\"serviceId\\\":44425396750,\\\"title\\\":\\\"全国联保\\\",\\\"tmserSpuCode\\\":\\\"Bear/小熊全国联保-6969\\\",\\\"totalFee\\\":\\\"0.00\\\"}],\\\"shippingType\\\":\\\"express\\\",\\\"snapshotUrl\\\":\\\"i:1324013142513233_1\\\",\\\"status\\\":\\\"TRADE_FINISHED\\\",\\\"tid\\\":1324013142513233,\\\"title\\\":\\\"小熊哥登专卖店\\\",\\\"totalFee\\\":\\\"299.00\\\",\\\"tradeFrom\\\":\\\"WAP,WAP\\\",\\\"type\\\":\\\"fixed\\\"}\"}"
    val mapper = new ObjectMapper() with ScalaObjectMapper
    mapper.registerModule(DefaultScalaModule)
    mapper.setSerializationInclusion(JsonInclude.Include.NON_NULL)
    mapper.disable(SerializationFeature.FAIL_ON_EMPTY_BEANS)
    mapper.disable(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES)
    val myMap = mapper.readValue[Map[String,Any]](json).get("payload").get.toString
    val yourMap = mapper.readValue[Trade](myMap)
    println(yourMap)
  }

}